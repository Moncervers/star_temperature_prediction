# Прогнозирование температуры звёзд

Модель нейронной сети для определения абсолютной температуры звёзд на основе их характеристик (светимость, радиус, цвет, тип)

---

## Содержание
1. [Описание проекта](#описание-проекта)  
2. [Технологии и инструменты](#технологии-и-инструменты)  
3. [Этапы работы](#этапы-работы)  
4. [Результаты](#результаты)  
5. [Ключевые выводы](#ключевые-выводы)  

---

## Описание проекта

**Цель:** Разработать нейронную сеть для прогнозирования температуры звёзд (в кельвинах) на основе их характеристик.  

**Зачем это нужно?**
- Замена традиционных методов (закон Вина, спектральный анализ) на более точный ML-подход.
- Анализ влияния параметров звёзд на их температуру.
- Исследование возможности применения глубокого обучения в астрофизике.

**Данные:**  
- 240 записей о звездах.  
- Признаки:  
  - Относительная светимость (`L/Lo`)  
  - Относительный радиус (`R/Ro`)  
  - Абсолютная звёздная величина (`Mv`)  
  - Цвет звезды  
  - Тип звезды (6 категорий: коричневые/красные/белые карлики, главная последовательность, сверхгиганты, гипергиганты)  
- Целевая переменная: **Абсолютная температура (K)**.

---

## Технологии и инструменты

- **Python:** `pandas`, `numpy`, `torch`, `optuna`, `scikit-learn`, `matplotlib`, `seaborn`, `shap`.
- **Обработка данных:**  
  - Удаление дубликатов.  
  - Кодирование категориальных признаков (One-Hot Encoding).  
  - Масштабирование числовых данных.  
- **Моделирование:**  
  - Глубокая нейронная сеть с BatchNorm, Dropout и различными функциями активации.  
  - Подбор гиперпараметров через Optuna.  
- **Визуализация:**  
  - Диаграммы рассеяния для анализа распределений.  
  - SHAP-анализ для оценки важности признаков.

---

## Этапы работы

### 1. Предобработка данных
- Удаление столбца с индексами (`unnamed`).  
- Обработка неявных дубликатов в цвете звезд (например, объединение `Blue White` и `Blue-White`).  
- Масштабирование числовых признаков (`StandardScaler`).  
- Кодирование типа звезды (ordinal encoding) и цвета (One-Hot Encoding).

### 2. Подбор гиперпараметров
- Использование Optuna для оптимизации:  
  - Количество слоёв (1–8).  
  - Количество нейронов (4–64).  
  - Тип активаций (ReLU, ELU, Tanh).  
  - Dropout (0–0.9).  
  - Размер батча (32, 64, 128).  

### 3. Анализ результатов
- SHAP для оценки важности признаков.  
- Визуализация ошибок модели на тестовой выборке.  

---

## Результаты

### Лучшая модель
- **RMSE:** 4049 K.  
- **Архитектура:**  
  - 3 скрытых слоя.  
  - BatchNorm в первых двух слоях.  
  - Активации: ReLU и Tanh.  
  - Dropout: 0.4–0.55.  

### Ключевые факторы
1. **Светимость** (`L/Lo`) — наибольшее влияние на температуру.  
2. **Радиус** (`R/Ro`) — коррелирует с типом звезды.  
3. **Цвет** — сине-белые звёзды имеют высокую температуру.  
4. **Тип звезды** — гипергиганты и сверхгиганты требуют особого внимания.  

### Ограничения
- Модель слабо предсказывает звёзды с температурой > 10,000 K (дисбаланс классов).  
- Выбросы в данных (например, аномально большие радиусы у гипергигантов).  

---

## Ключевые выводы

1. **Эффективность ML:**  
   Нейросеть превзошла традиционные методы с RMSE ~4050 K.  
2. **Важные признаки:**  
   - Светимость и радиус — основные факторы.  
   - Цвет и тип звезды помогают уточнить прогноз.  
3. **Рекомендации:**  
   - Добавить данные о звездах с высокой температурой для балансировки.  
   - Применить устойчивые функции потерь (Huber Loss) для обработки выбросов.  
   - Провести ансамблирование с деревьями решений (XGBoost, CatBoost).